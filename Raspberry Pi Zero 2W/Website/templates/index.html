<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="A real-time dashboard displaying live IoT sensor data including temperature and humidity.">

  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}">

  <title>IoT Live Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body>
  <div class="container py-5">
    <h1 class="text-center text-primary mb-4" aria-label="Live IoT Sensor Data">Live IoT Sensor Data</h1>

    <div class="text-center fs-2">
      Temperature: <span id="temperature">--</span> Â°C<br />
      Humidity: <span id="humidity">--</span> %
    </div>

    <div class="text-center mt-3 text-muted" id="timestamp">Last updated: --</div>
  </div>

  <script>
    const socket = io();

    function updateValue(id, value) {
      const el = document.getElementById(id);
      el.textContent = value;
      el.classList.add('updated');
      setTimeout(() => el.classList.remove('updated'), 300);
    }

    function getCurrentTime24h() {
      const now = new Date();
      return now.toLocaleTimeString('en-GB'); // 'en-GB' uses 24-hour format
    }

    socket.on('sensor_update', function(data) {
      updateValue('temperature', data.temperature);
      updateValue('humidity', data.humidity);
      document.getElementById('timestamp').textContent = 'Last updated: ' + getCurrentTime24h();
    });
  </script>
</body>
</html>
